# Frontend build stage for Tailwind CSS
FROM node:20-alpine AS frontend-builder

WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm install

# Copy source files
COPY tailwind.config.js ./
COPY postcss.config.js ./
COPY static/src/ ./static/src/
COPY templates/ ./templates/

# Build CSS
RUN npm run build-css-prod

# Production stage - copy built assets
FROM alpine:latest AS assets
COPY --from=frontend-builder /app/static/admin/css/ /static/admin/css/