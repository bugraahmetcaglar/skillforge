[pytest]
minversion = 8.4.1
DJANGO_SETTINGS_MODULE = skillforge.settings.test
testpaths = tests
addopts =
    # Pass Django settings as opts
    --ds=skillforge.settings.test
    # Disable migrations for faster tests
    --no-migrations
    # Log system output
    --capture=sys
    # Reuse database for faster tests
    --reuse-db
    # Create database if needed
    --create-db
    # Verbose output
    --verbose
    # Exit at first failure
    ; --exitfirst
    ; # Use IPython debugger instead of pdb
    ; --pdbcls=IPython.terminal.debugger:Pdb
    --pdb
    # Unknown marks trigger errors
    --strict-markers
    # Show extra info on xfailed, xpassed, and skipped tests
    -rxXs
    # Omit scripts directory and other irrelevant paths
    --ignore-glob=**/scripts/**
    --ignore-glob=**/node_modules/**
    --ignore-glob=**/venv/**
    --ignore-glob=**/.git/**
    # Allow same file names in different directories
    --import-mode=importlib
    # Disable warnings for cleaner output
    --disable-warnings
    # Clear cache to avoid conflicts
    --cache-clear
    # Modern pytest features
    --tb=short
python_files = test_*.py
python_classes = Test*
python_functions = test_*
filterwarnings =
    # PostgreSQL/psycopg related warnings
    ignore:.*psycopg.*:UserWarning
    ignore:.*psycopg.*:DeprecationWarning
    # Django timezone warnings
    ignore:DateTimeField .*received a naive datetime.*:RuntimeWarning
    # Django model warnings
    ignore:.*models.Model.*:DeprecationWarning
    # Third party package warnings
    ignore::DeprecationWarning:rest_framework.*
    ignore::DeprecationWarning:django_filters.*
    ignore::DeprecationWarning:corsheaders.*
    # pytest-django warnings
    ignore::pytest.PytestUnraisableExceptionWarning
    ignore::pytest.PytestCollectionWarning
    # Redis warnings (if using redis for cache/celery)
    ignore:.*redis.*:DeprecationWarning
    # JSON field warnings (PostgreSQL specific)
    ignore:.*JSONField.*:DeprecationWarning
markers =
    unit: Unit tests that test small, isolated components
    integration: Tests that cover interaction between different components
    e2e: End-to-end tests that test the full application
    model: Tests for Django models
    view: Tests for Django views
    serializer: Tests for DRF serializers
    api: Tests for API endpoints
    current: Tests that are currently being developed or modified
    external: Tests that make external API calls

# Django debug mode
django_debug_mode = keep
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

norecursedirs = 
    .git
    .pytest_cache
    __pycache__
    scripts
    venv
    node_modules
    staticfiles
    media
    .tox
    dist
    build